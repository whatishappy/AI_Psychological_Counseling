<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å†¥æƒ³ç»ƒä¹  - å¿ƒçµä¼´ä¾£</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf9 100%);
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* å¯¼èˆªæ  */
        header {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #6a67ce;
        }

        .nav-links {
            display: flex;
            list-style: none;
        }

        .nav-links li {
            margin-left: 30px;
        }

        .nav-links a {
            text-decoration: none;
            color: #555;
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: #6a67ce;
        }

        .cta-button {
            background: #6a67ce;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
        }

        .cta-button:hover {
            background: #5a57c5;
        }

        /* ç”¨æˆ·ä¿¡æ¯æŒ‰é’® */
        .user-info {
            display: none;
            position: relative;
        }

        .user-button {
            background: #6a67ce;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .user-menu {
            position: absolute;
            top: 50px;
            right: 0;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            padding: 15px;
            width: 200px;
            display: none;
            z-index: 1001;
        }

        .user-menu.show {
            display: block;
        }
        
        .user-menu p {
            margin: 0 0 10px 0;
            font-weight: 500;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .user-menu button {
            display: block;
            width: 100%;
            padding: 10px;
            background: #f5f5f5;
            border: none;
            border-radius: 5px;
            text-align: left;
            cursor: pointer;
            margin-bottom: 5px;
            transition: background 0.3s;
        }
        
        .user-menu button:hover {
            background: #e0e0e0;
        }

        /* ç™»å½•/æ³¨å†ŒæŒ‰é’® */
        .auth-button {
            background: transparent;
            color: #6a67ce;
            border: 2px solid #6a67ce;
            padding: 8px 16px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            margin-left: 15px;
        }

        .auth-button:hover {
            background: #f0f0ff;
        }

        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .main-content {
            padding: 120px 0 50px;
        }

        .page-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .page-header h1 {
            font-size: 2.5rem;
            color: #333;
            margin-bottom: 15px;
        }

        .page-header p {
            font-size: 1.2rem;
            color: #666;
            max-width: 700px;
            margin: 0 auto;
        }

        /* å†¥æƒ³ä»‹ç» */
        .introduction {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            padding: 40px;
            margin-bottom: 40px;
        }

        .introduction h2 {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 20px;
        }

        .introduction p {
            margin-bottom: 15px;
            line-height: 1.8;
        }

        /* å†¥æƒ³ç±»å‹ */
        .meditation-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .type-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            padding: 30px;
            text-align: center;
            transition: transform 0.3s;
        }

        .type-card:hover {
            transform: translateY(-10px);
        }

        .type-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #6a67ce;
        }

        .type-card h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #333;
        }

        .type-card p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .start-button {
            background: #6a67ce;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s;
        }

        .start-button:hover {
            background: #5a57c5;
        }

        /* å†¥æƒ³æ’­æ”¾å™¨ */
        .meditation-player {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            padding: 40px;
            margin-bottom: 40px;
            text-align: center;
        }

        .player-header {
            margin-bottom: 30px;
        }

        .player-header h2 {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 10px;
        }

        .player-header p {
            color: #666;
        }

        .timer {
            font-size: 4rem;
            font-weight: 300;
            color: #6a67ce;
            margin: 30px 0;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }

        .control-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            background: #f0f0f0;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }

        .control-button:hover {
            background: #e0e0e0;
        }

        .control-button.play-pause {
            background: #6a67ce;
            color: white;
            width: 70px;
            height: 70px;
        }

        .control-button.play-pause:hover {
            background: #5a57c5;
        }

        .progress-container {
            max-width: 500px;
            margin: 30px auto;
        }

        .progress-bar {
            height: 8px;
            background: #eee;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: #6a67ce;
            width: 0%;
            transition: width 0.1s;
        }

        .time-info {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            color: #666;
        }

        /* æŒ‡å¯¼è¯­ */
        .instructions {
            background: #f9f9ff;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            text-align: left;
        }

        .instructions h3 {
            color: #6a67ce;
            margin-bottom: 15px;
        }

        .instructions ol {
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 10px;
        }

        /* åº•éƒ¨ */
        footer {
            background: #333;
            color: white;
            padding: 50px 0 20px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-column h3 {
            margin-bottom: 20px;
            color: #6a67ce;
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column ul li {
            margin-bottom: 10px;
        }

        .footer-column ul li a {
            color: #ccc;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-column ul li a:hover {
            color: #6a67ce;
        }

        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid #444;
            color: #aaa;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .introduction, .meditation-player {
                padding: 20px;
            }
            
            .controls {
                gap: 10px;
            }
            
            .control-button {
                width: 50px;
                height: 50px;
            }
            
            .control-button.play-pause {
                width: 60px;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <header>
        <div class="container">
            <nav>
                <div class="logo">å¿ƒçµä¼´ä¾£</div>
                <ul class="nav-links">
                    <li><a href="index.html">é¦–é¡µ</a></li>
                    <li><a href="index.html#features">åŠŸèƒ½</a></li>
                    <li><a href="index.html#testimonials">ç”¨æˆ·è¯„ä»·</a></li>
                    <li><a href="index.html#contact">è”ç³»æˆ‘ä»¬</a></li>
                </ul>
                <div class="user-info" id="user-info">
                    <button class="user-button" id="user-button">U</button>
                    <div class="user-menu" id="user-menu">
                        <p>ç”¨æˆ·èœå•</p>
                        <div id="user-profile-info">
                            <p>ç”¨æˆ·å: <span id="user-name"></span></p>
                            <p>æ˜µç§°: <span id="profile-nickname"></span></p>
                            <p>æ€§åˆ«:<span id="profile-gender"></span><span id="profile-zodiac"></span></p>
                        </div>
                        <button id="profile-btn">ä¸ªäººä¿¡æ¯</button>
                        <button id="logout-btn">é€€å‡ºç™»å½•</button>
                    </div>
                </div>
                <button class="auth-button" id="auth-button" style="display: none;">ç™»å½•/æ³¨å†Œ</button>
                <button class="cta-button" onclick="goToChat()">å¼€å§‹èŠå¤©</button>
            </nav>
        </div>
    </header>

    <!-- ä¸»è¦å†…å®¹ -->
    <section class="main-content">
        <div class="container">
            <div class="page-header">
                <h1>å†¥æƒ³ç»ƒä¹ </h1>
                <p>é€šè¿‡å¼•å¯¼å¼å†¥æƒ³å’Œå‘¼å¸ç»ƒä¹ ï¼Œå¸®åŠ©æ‚¨æ”¾æ¾èº«å¿ƒï¼Œå‡è½»å‹åŠ›</p>
            </div>

            <!-- å†¥æƒ³ä»‹ç» -->
            <div class="introduction">
                <h2>å†¥æƒ³çš„ç›Šå¤„</h2>
                <p>å†¥æƒ³æ˜¯ä¸€ç§è®­ç»ƒæ³¨æ„åŠ›å’Œæ„è¯†çš„ç»ƒä¹ ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è·å¾—æ›´æ·±å±‚æ¬¡çš„å†…å¿ƒå¹³é™å’Œç²¾ç¥æ¸…æ™°ã€‚ç§‘å­¦ç ”ç©¶è¡¨æ˜ï¼Œå®šæœŸå†¥æƒ³å¯ä»¥ï¼š</p>
                <ul>
                    <li>å‡è½»å‹åŠ›å’Œç„¦è™‘</li>
                    <li>æ”¹å–„ç¡çœ è´¨é‡</li>
                    <li>å¢å¼ºä¸“æ³¨åŠ›å’Œæ³¨æ„åŠ›</li>
                    <li>æå‡æƒ…ç»ªè°ƒèŠ‚èƒ½åŠ›</li>
                    <li>é™ä½è¡€å‹å’Œå¿ƒç‡</li>
                    <li>å¢å¼ºå…ç–«ç³»ç»ŸåŠŸèƒ½</li>
                </ul>
                <p>æ— è®ºæ‚¨æ˜¯åˆå­¦è€…è¿˜æ˜¯æœ‰ç»éªŒçš„å†¥æƒ³è€…ï¼Œæˆ‘ä»¬æä¾›å¤šç§å†¥æƒ³ç»ƒä¹ ï¼Œå¸®åŠ©æ‚¨åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­æ‰¾åˆ°å†…å¿ƒçš„å®é™ã€‚</p>
            </div>

            <!-- å†¥æƒ³ç±»å‹ -->
            <div class="meditation-types">
                <div class="type-card">
                    <div class="type-icon">ğŸ§˜</div>
                    <h3>æ­£å¿µå†¥æƒ³</h3>
                    <p>ä¸“æ³¨äºå½“ä¸‹çš„ä½“éªŒï¼Œè§‚å¯Ÿè‡ªå·±çš„æ€æƒ³å’Œæ„Ÿå—è€Œä¸åšè¯„åˆ¤ã€‚</p>
                    <button class="start-button" onclick="startMeditation('mindfulness')">å¼€å§‹ç»ƒä¹ </button>
                </div>
                <div class="type-card">
                    <div class="type-icon">ğŸŒ¬ï¸</div>
                    <h3>å‘¼å¸å†¥æƒ³</h3>
                    <p>é€šè¿‡ä¸“æ³¨äºå‘¼å¸æ¥å¹³é™å¿ƒçµï¼Œæ˜¯æœ€åŸºç¡€ä¹Ÿæ˜¯æœ€æœ‰æ•ˆçš„å†¥æƒ³æ–¹å¼ã€‚</p>
                    <button class="start-button" onclick="startMeditation('breathing')">å¼€å§‹ç»ƒä¹ </button>
                </div>
                <div class="type-card">
                    <div class="type-icon">ğŸ’–</div>
                    <h3>æ…ˆå¿ƒå†¥æƒ³</h3>
                    <p>åŸ¹å…»å¯¹è‡ªå·±å’Œä»–äººçš„å–„æ„ä¸åŒæƒ…å¿ƒï¼Œæå‡æƒ…æ„Ÿå¥åº·ã€‚</p>
                    <button class="start-button" onclick="startMeditation('loving-kindness')">å¼€å§‹ç»ƒä¹ </button>
                </div>
            </div>

            <!-- å†¥æƒ³æ’­æ”¾å™¨ -->
            <div class="meditation-player">
                <div class="player-header">
                    <h2>å‘¼å¸å†¥æƒ³</h2>
                    <p>5åˆ†é’ŸåŸºç¡€å‘¼å¸ç»ƒä¹ </p>
                </div>
                
                <div class="timer" id="timer">5:00</div>
                
                <div class="controls">
                    <button class="control-button" onclick="decreaseTime()">-</button>
                    <button class="control-button play-pause" onclick="toggleMeditation()" id="play-pause">â–¶</button>
                    <button class="control-button" onclick="increaseTime()">+</button>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress" id="progress"></div>
                    </div>
                    <div class="time-info">
                        <span id="current-time">0:00</span>
                        <span id="total-time">5:00</span>
                    </div>
                </div>
                
                <div class="instructions">
                    <h3>æŒ‡å¯¼è¯­</h3>
                    <ol>
                        <li>æ‰¾ä¸€ä¸ªå®‰é™èˆ’é€‚çš„åœ°æ–¹åä¸‹æˆ–èººä¸‹ï¼Œé—­ä¸Šçœ¼ç›</li>
                        <li>å°†æ³¨æ„åŠ›é›†ä¸­åœ¨ä½ çš„å‘¼å¸ä¸Šï¼Œæ„Ÿå—ç©ºæ°”è¿›å‡ºèº«ä½“çš„æ„Ÿè§‰</li>
                        <li>å½“ä½ æ³¨æ„åˆ°æ€ç»ªé£˜èµ°æ—¶ï¼Œæ¸©æŸ”åœ°å°†æ³¨æ„åŠ›å¸¦å›å‘¼å¸</li>
                        <li>ä¸è¦è¯„åˆ¤è‡ªå·±ï¼Œè¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œæ¯æ¬¡æ³¨æ„åˆ°éƒ½æ˜¯æˆåŠŸçš„</li>
                        <li>ç»§ç»­ä¿æŒä¸“æ³¨ï¼Œè®©å‘¼å¸è‡ªç„¶åœ°è¿›è¡Œ</li>
                    </ol>
                </div>
            </div>
        </div>
    </section>

    <!-- åº•éƒ¨ -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>å¿ƒçµä¼´ä¾£</h3>
                    <p>æ‚¨çš„ä¸“å±AIå¿ƒç†å’¨è¯¢å¸ˆï¼Œ24å°æ—¶åœ¨çº¿é™ªä¼´ï¼Œä¿æŠ¤éšç§ï¼Œä¸“ä¸šæ”¯æŒã€‚</p>
                </div>
                <div class="footer-column">
                    <h3>åŠŸèƒ½</h3>
                    <ul>
                        <li><a href="#">AIå¿ƒç†èŠå¤©</a></li>
                        <li><a href="#">æƒ…ç»ªè¿½è¸ª</a></li>
                        <li><a href="#">è®¤çŸ¥é‡æ„</a></li>
                        <li><a href="#">å†¥æƒ³ç»ƒä¹ </a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>èµ„æº</h3>
                    <ul>
                        <li><a href="#">å¿ƒç†æµ‹è¯•</a></li>
                        <li><a href="#">çŸ¥è¯†åº“</a></li>
                        <li><a href="#">æƒ…ç»ªè¿½è¸ª</a></li>
                        <li><a href="#">å¿ƒç†æµ‹è¯•</a></li>
                        <li><a href="#">å†¥æƒ³ç»ƒä¹ </a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>æ”¯æŒ</h3>
                    <ul>
                        <li><a href="#">å¸®åŠ©ä¸­å¿ƒ</a></li>
                        <li><a href="#">éšç§æ”¿ç­–</a></li>
                        <li><a href="#">æœåŠ¡æ¡æ¬¾</a></li>
                        <li><a href="#">è”ç³»æˆ‘ä»¬</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2025 å¿ƒçµä¼´ä¾£. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚</p>
            </div>
        </div>
    </footer>

    <script>
        // å†¥æƒ³è®¡æ—¶å™¨å˜é‡
        let timer;
        let isRunning = false;
        let currentTime = 0; // ç§’
        let totalTime = 300; // 5åˆ†é’Ÿ = 300ç§’
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateTimerDisplay();
            updateTotalTimeDisplay();
            
            // æ£€æŸ¥ç”¨æˆ·ç™»å½•çŠ¶æ€
            checkUserStatus();
        });
        
        // å¼€å§‹å†¥æƒ³
        function startMeditation(type) {
            // æ ¹æ®ç±»å‹æ›´æ–°æ’­æ”¾å™¨ç•Œé¢
            const titles = {
                'mindfulness': 'æ­£å¿µå†¥æƒ³',
                'breathing': 'å‘¼å¸å†¥æƒ³',
                'loving-kindness': 'æ…ˆå¿ƒå†¥æƒ³'
            };
            
            const descriptions = {
                'mindfulness': '10åˆ†é’Ÿæ­£å¿µç»ƒä¹ ',
                'breathing': '5åˆ†é’ŸåŸºç¡€å‘¼å¸ç»ƒä¹ ',
                'loving-kindness': '12åˆ†é’Ÿæ…ˆå¿ƒç»ƒä¹ '
            };
            
            const times = {
                'mindfulness': 600,
                'breathing': 300,
                'loving-kindness': 720
            };
            
            document.querySelector('.player-header h2').textContent = titles[type] || 'å‘¼å¸å†¥æƒ³';
            document.querySelector('.player-header p').textContent = descriptions[type] || '5åˆ†é’ŸåŸºç¡€å‘¼å¸ç»ƒä¹ ';
            
            totalTime = times[type] || 300;
            currentTime = 0;
            
            updateTimerDisplay();
            updateTotalTimeDisplay();
            
            // æ»šåŠ¨åˆ°æ’­æ”¾å™¨
            document.querySelector('.meditation-player').scrollIntoView({ behavior: 'smooth' });
        }
        
        // åˆ‡æ¢å†¥æƒ³çŠ¶æ€ï¼ˆå¼€å§‹/æš‚åœï¼‰
        function toggleMeditation() {
            const playPauseButton = document.getElementById('play-pause');
            
            if (isRunning) {
                // æš‚åœ
                clearInterval(timer);
                playPauseButton.textContent = 'â–¶';
                isRunning = false;
            } else {
                // å¼€å§‹
                timer = setInterval(updateTimer, 1000);
                playPauseButton.textContent = 'â¸';
                isRunning = true;
            }
        }
        
        // æ›´æ–°è®¡æ—¶å™¨
        function updateTimer() {
            if (currentTime < totalTime) {
                currentTime++;
                updateTimerDisplay();
                updateProgressBar();
            } else {
                // å†¥æƒ³ç»“æŸ
                clearInterval(timer);
                isRunning = false;
                document.getElementById('play-pause').textContent = 'â–¶';
                alert('å†¥æƒ³ç»ƒä¹ å®Œæˆï¼æ­å–œä½ å®Œæˆäº†æœ¬æ¬¡ç»ƒä¹ ã€‚');
            }
        }
        
        // æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
        function updateTimerDisplay() {
            const remainingTime = totalTime - currentTime;
            const minutes = Math.floor(remainingTime / 60);
            const seconds = remainingTime % 60;
            document.getElementById('timer').textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            document.getElementById('current-time').textContent = formatTime(currentTime);
        }
        
        // æ›´æ–°è¿›åº¦æ¡
        function updateProgressBar() {
            const progressPercentage = (currentTime / totalTime) * 100;
            document.getElementById('progress').style.width = `${progressPercentage}%`;
        }
        
        // æ›´æ–°æ€»æ—¶é—´æ˜¾ç¤º
        function updateTotalTimeDisplay() {
            document.getElementById('total-time').textContent = formatTime(totalTime);
        }
        
        // æ ¼å¼åŒ–æ—¶é—´æ˜¾ç¤º
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
        }
        
        // å¢åŠ æ—¶é—´
        function increaseTime() {
            if (!isRunning) {
                totalTime += 60; // å¢åŠ 1åˆ†é’Ÿ
                if (totalTime > 3600) totalTime = 3600; // æœ€å¤§60åˆ†é’Ÿ
                updateTotalTimeDisplay();
                if (currentTime > totalTime) {
                    currentTime = totalTime;
                    updateTimerDisplay();
                }
                updateProgressBar();
            }
        }
        
        // å‡å°‘æ—¶é—´
        function decreaseTime() {
            if (!isRunning) {
                totalTime -= 60; // å‡å°‘1åˆ†é’Ÿ
                if (totalTime < 60) totalTime = 60; // æœ€å°1åˆ†é’Ÿ
                updateTotalTimeDisplay();
                if (currentTime > totalTime) {
                    currentTime = totalTime;
                    updateTimerDisplay();
                }
                updateProgressBar();
            }
        }
        
        // æ£€æŸ¥ç”¨æˆ·çŠ¶æ€å¹¶æ›´æ–°UI
        function checkUserStatus() {
            try {
                const token = localStorage.getItem('token');
                const user = JSON.parse(localStorage.getItem('user') || '{}');
                const userProfile = JSON.parse(localStorage.getItem('userProfile') || '{}');
                
                const userInfo = document.getElementById('user-info');
                const authButton = document.getElementById('auth-button');
                const userName = document.getElementById('user-name');
                const userButton = document.getElementById('user-button');
                const profileNickname = document.getElementById('profile-nickname');
                const profileGender = document.getElementById('profile-gender');
                const profileZodiac = document.getElementById('profile-zodiac');
                
                if (token && user) {
                    // ç”¨æˆ·å·²ç™»å½•
                    if (userInfo) userInfo.style.display = 'block';
                    if (authButton) authButton.style.display = 'none';
                    if (userName) userName.textContent = user.username;
                    
                    // è®¾ç½®ç”¨æˆ·æŒ‰é’®æ˜¾ç¤ºé¦–å­—æ¯
                    if (userButton) {
                        userButton.textContent = user.username.charAt(0).toUpperCase();
                    }
                    
                    // æ˜¾ç¤ºç”¨æˆ·ä¸ªäººä¿¡æ¯
                    if (profileNickname) {
                        profileNickname.textContent = userProfile.nickname || '';
                    }
                    
                    if (profileGender) {
                        const genderText = userProfile.gender === 'female' ? 'å¥³' : 
                                         userProfile.gender === 'male' ? 'ç”·' : '';
                        profileGender.textContent = genderText ? ` ${genderText}` : '';
                    }
                    
                    if (profileZodiac) {
                        profileZodiac.textContent = userProfile.zodiac ? ` ${userProfile.zodiac}` : '';
                    }
                } else {
                    // ç”¨æˆ·æœªç™»å½•
                    if (userInfo) userInfo.style.display = 'none';
                    if (authButton) authButton.style.display = 'block';
                }
            } catch (error) {
                console.error('Error checking user status:', error);
            }
        }
        
        // ç»‘å®šç”¨æˆ·èœå•äº‹ä»¶
        function bindUserMenuEvents() {
            try {
                const userButton = document.getElementById('user-button');
                const userMenu = document.getElementById('user-menu');
                const logoutBtn = document.getElementById('logout-btn');
                const profileBtn = document.getElementById('profile-btn');
                
                if (userButton) {
                    userButton.addEventListener('click', function(e) {
                        e.stopPropagation();
                        if (userMenu) {
                            userMenu.classList.toggle('show');
                        }
                    });
                }
                
                if (profileBtn) {
                    profileBtn.addEventListener('click', function() {
                        window.location.href = 'profile.html';
                    });
                }
                
                if (logoutBtn) {
                    logoutBtn.addEventListener('click', function() {
                        // æ¸…é™¤ç”¨æˆ·ä¿¡æ¯
                        localStorage.removeItem('token');
                        localStorage.removeItem('user');
                        localStorage.removeItem('userProfile');
                        
                        // éšè—ç”¨æˆ·èœå•
                        if (userMenu) userMenu.classList.remove('show');
                        
                        // éšè—ç”¨æˆ·ä¿¡æ¯æŒ‰é’®ï¼Œæ˜¾ç¤ºç™»å½•æŒ‰é’®
                        const userInfo = document.getElementById('user-info');
                        const authButton = document.getElementById('auth-button');
                        const userButton = document.getElementById('user-button');
                        if (userInfo) userInfo.style.display = 'none';
                        if (authButton) authButton.style.display = 'block';
                        if (userButton) userButton.textContent = 'U'; // é‡ç½®ä¸ºé»˜è®¤å€¼
                        
                        alert('å·²æˆåŠŸç™»å‡º');
                    });
                }
                
                // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹éšè—èœå•
                document.addEventListener('click', function(e) {
                    if (userMenu && !userMenu.contains(e.target) && userButton !== e.target) {
                        userMenu.classList.remove('show');
                    }
                });
            } catch (error) {
                console.error('Error binding user menu events:', error);
            }
        }
        
        // è·³è½¬åˆ°èŠå¤©åŠŸèƒ½
        function goToChat() {
            try {
                const token = localStorage.getItem('token');
                if (token) {
                    // å·²ç™»å½•ç”¨æˆ·è·³è½¬åˆ°é¦–é¡µçš„èŠå¤©ç•Œé¢
                    window.location.href = 'index.html#chat';
                } else {
                    // æœªç™»å½•ç”¨æˆ·æ˜¾ç¤ºç™»å½•æ¨¡æ€æ¡†
                    alert('è¯·å…ˆç™»å½•');
                    window.location.href = 'index.html';
                }
            } catch (error) {
                console.error('Error in goToChat:', error);
            }
        }
    </script>
</body>
</html>